name: CI

on:
  push:
    branches:
      - main
      - dev
  pull_request:
    branches:
      - main
      - dev
  # Allows you to run this workflow manually from the Actions tab
  workflow_dispatch:

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
        with:
          submodules: true  

      - uses: actions/setup-node@v2
        with:
          node-version: '16'

      - name: Install sudo package
        run: apt update && apt install sudo

      - name: Install dependencies
        run: |
          sudo apt-get update && sudo apt-get install -y curl zsh wget build-essential gnupg fonts-ipafont-gothic fonts-wqy-zenhei fonts-thai-tlwg fonts-kacst fonts-freefont-ttf libxss1

      - name: Install Google Chrome
        run: |
          sudo wget -q -O - https://dl-ssl.google.com/linux/linux_signing_key.pub | sudo apt-key add -
          sudo sh -c 'echo "deb [arch=amd64] http://dl.google.com/linux/chrome/deb/ stable main" >> /etc/apt/sources.list.d/google-chrome.list'
          sudo apt-get update
          sudo apt-get install -y google-chrome-unstable
      
      - name: Install MARP
        run: |
          npm install -g @marp-team/marp-cli

      - name: Build artifacts for drones-101
        run: |
          cd drones-101 && make 
